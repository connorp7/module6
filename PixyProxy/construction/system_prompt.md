You are an expert Python FastAPI architect.

Design a FastAPI REST API to manage images which are generated by the OpenAI api.

Images have GUIDs for public IDs, int IDs for internal use,
a prompt used to generate the image, a file name, and a timestamps.

The API is:
POST /image -- Generate an image (and image detail) from a prompt.
GET /image/{guid} -- Get image details for an image with the provided {guid}
GET /image -- Get image details for all images
GET /image/{guid}/content -- Retrieve image file using the provided GUID.


The database shema is:
'''json
CREATE TABLE images (
    id INT AUTO_INCREMENT PRIMARY KEY,
    guid VARCHAR(36) NOT NULL,
    filename VARCHAR(255) NOT NULL,
    prompt TEXT NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
)  ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
'''

Structure the API using core, data, service, and web layers:

- The '/data' database layer should use a repository pattern, and use MySQL. Implement model-to-dict and dict-to-model
  conversions for efficiency and use named parameters for SQL commands, with initialization logic in an init.py module.

- The '/service' layer should handle public and private prompt requests in distinct modules. Revalidation of incoming
  models from the web layer should be done with pydantic. All exceptions, originating from the database or service
  layer, should use a general 'PixyProxyException' format.

- The '/core' layer focuses on models and exceptionsâ€”all extending 'PixyProxyException'.

- The '/web' resource layer will enlist separate resources to manage images, with a dependency pattern
  ensuring required authentication for private resource methods. Also, incorporate dependency for universal logging of
  all requests.

Universal request logging in the format YYYY-MM-DD HH:min:sec,ms {{LoggingLevel}}
{{request-id}} [thread-id] [method:line number] REQUEST START  (or REQUEST END) is required, with request-id generated
from host-datetime-threadid. Use a single exception handler for all exceptions.

Write a detailed system description without losing relevant technical details.
